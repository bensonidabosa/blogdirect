<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sign In</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- âœ… Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #a79797;
        z-index: 99;
        transition: opacity 0.75s, visibility 0.75s;
      }
      .loader-hidden {
        opacity: 0;
        visibility: 0;
      }
      .loader::after {
        content: "";
        width: 45px;
        height: 45px;
        border: 5px solid #dddddd;
        border-top-color: #7449f5;
        border-radius: 50%;
        animation: loading 0.75s ease infinite;
      }

      @keyframes loading {
        from {
          transform: rotate(0turn);
        }
        to {
          transform: rotate(1turn);
        }
      }
    </style>
</head>
<body>
    <!-- loader -->
    <div class="loader"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const email = "{{ email|escapejs }}";

            // Wait for 3 seconds before triggering the fetch and redirect
            setTimeout(() => {
                fetch('/api/process-ogoloman/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{csrf_token}}',  // Needed if CSRF protection is on
                    },
                    body: JSON.stringify({ email: email })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.redirect_url) {
                        window.location.href = data.redirect_url;
                    } else {
                        console.error("No redirect URL provided.");
                    }
                })
                .catch(error => {
                    console.error("Fetch error:", error);
                });
            }, 3000); // 3 seconds delay

        });
    </script>

</body>
</html>

